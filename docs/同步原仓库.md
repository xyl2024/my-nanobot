# 同步原仓库指南

本文档介绍如何从上游（原始）仓库定期获取更新。

## 添加上游远程仓库

```bash
# 添加上游仓库
git remote add upstream https://github.com/HKUDS/nanobot

# 验证远程仓库
git remote -v
```

## 定期同步

```bash
# 1. 获取上游最新代码
git fetch upstream

# 2. 切换到主分支
git checkout main

# 3. 合并上游更新
git merge upstream/main
```

## 处理冲突

如果上游和你的修改有冲突：

```bash
# 1. 查看冲突文件
git status

# 2. 手动解决冲突（编辑冲突文件）

# 3. 标记冲突已解决
git add .

# 4. 完成合并提交
git commit -m "Merge upstream changes and resolve conflicts"
```

## 推荐：使用 Rebase 保持提交历史整洁

如果你希望保持线性提交历史，使用 rebase：

```bash
git fetch upstream
git rebase upstream/main
```

## 最佳实践

1. **定期同步**：不要等积累大量改动后再同步，冲突会很大

2. **先备份**：同步前可以创建一个备份分支
   ```bash
   git checkout -b backup-before-merge
   ```

3. **处理格式化冲突**：如果你有代码格式化改动，合并时可能产生大量冲突。可以尝试：
   ```bash
   # 忽略空白符差异
   git merge -X ignore-all-space upstream/main
   ```

4. **自动化同步**：可以创建一个脚本定期执行

## 自动化脚本示例

创建 `scripts/sync-upstream.sh`：

```bash
#!/bin/bash
git fetch upstream
git checkout main
git merge upstream/main
git push origin main
```

然后定期运行（如每周）：
```bash
chmod +x scripts/sync-upstream.sh
./scripts/sync-upstream.sh
```
